{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Homelink - Demographic Data Form</title>
    <link rel="stylesheet" href="{% static 'css/form_styles.css' %}">
    <style>
        .homelink-header {
            text-align: center;
            background-color: #003366;
            color: white;
            padding: 15px;
            margin-bottom: 20px;
        }
        .homelink-header h2 {
            margin: 0;
        }
        .section-title {
            background-color: #f0f0f0;
            padding: 10px;
            margin-top: 20px;
            border-left: 4px solid #003366;
            font-weight: bold;
        }
    </style>
    <script>
        // Generate a random 10-digit username
        function generateRandomUsername() {
            return Math.floor(1000000000 + Math.random() * 9000000000).toString();
        }

        // Save username to localStorage if not already present
        function saveUsernameToLocalStorage() {
            let username = localStorage.getItem('homelink_username');
            if (!username) {
                username = generateRandomUsername();
                localStorage.setItem('homelink_username', username);
            }
            return username;
        }

        // Add the username as a query parameter to the current URL
        function appendUsernameToURL() {
            const username = saveUsernameToLocalStorage();
            const url = new URL(window.location.href);
            if (!url.searchParams.has('username')) {
                url.searchParams.append('username', username);
                window.history.replaceState({}, '', url.toString());
            }
        }

        // Append the username to the form data before submission
        function appendUsernameToForm() {
            const username = localStorage.getItem('homelink_username');
            if (username) {
                const form = document.querySelector('form');
                const input = document.createElement('input');
                input.type = 'hidden';
                input.name = 'username';
                input.value = username;
                form.appendChild(input);
            }
        }

        // Execute on page load
        document.addEventListener('DOMContentLoaded', function () {
            appendUsernameToURL();

            // Add submit event listener to include the username in the form
            const form = document.querySelector('form');
            form.addEventListener('submit', appendUsernameToForm);
        });
    </script>
</head>
<body>
    <div class="homelink-header">
        <h2>Homelink Employee Engagement Survey</h2>
        <p>SECTION 1: Demographic Information</p>
    </div>

    <form method="post">
        {% csrf_token %}
        
        <div class="section-title">Personal Information</div>
        
        <div>
            <label>Gender:</label>
            {{ form.gender }}
        </div>

        <div>
            <label>Age Profile:</label>
            {{ form.age_group }}
        </div>

        <div>
            <label>Length of Continuous Service (in years):</label>
            {{ form.work_experience }}
        </div>

        <div class="section-title">Organizational Information</div>
        
        <div>
            <label>Division:</label>
            {{ form.division }}
        </div>

        <div>
            <label>Department:</label>
            {{ form.department }}
        </div>

        <div>
            <label>Type of Employment Contract:</label>
            {{ form.contract_type }}
        </div>

        <div>
            <label>Function:</label>
            {{ form.designation }}
        </div>

        <div>
            <label>Location:</label>
            {{ form.location }}
        </div>

        <div class="section-title">Education Information</div>
        
        <div>
            <label>Highest Education Level Attained:</label>
            {{ form.highest_qualification }}
        </div>

        <p class="info-icon">Please fill in the following details accordingly:
            <span class='icon-icon'>ℹ️</span>
        </p>
        <div class="tooltip">
            Your responses will remain anonymous and confidential.<br>
            We value your privacy and ensure that your data will only be used for statistical purposes.
        </div>

        <button type="submit">Continue to Survey >></button>
    </form>
</body>
</html>